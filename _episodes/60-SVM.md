---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 60-SVM.md in _episodes_rmd/
title: "Support vector machines"
author: "Darya Vanichkina"
keypoints:
- somepoint
objectives:
- someobjective
questions: What is the meaning of life FIXME?
source: Rmd
start: 0
teaching: 30
exercises: 0
---





#Try with caret and kernlab



```r
set.seed(3233)

trctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
```

```
## Error in trainControl(method = "repeatedcv", number = 10, repeats = 3): could not find function "trainControl"
```

```r
training$cpw <- training$`concave points_worst`
```

```
## Error in eval(expr, envir, enclos): object 'training' not found
```

```r
tr_subset<-training[,.(radius_mean,cpw, diagnosis)]
```

```
## Error in eval(expr, envir, enclos): object 'training' not found
```

```r
tr_x_subset<-as.matrix(training[,.(radius_mean,cpw)])
```

```
## Error in as.matrix(training[, .(radius_mean, cpw)]): object 'training' not found
```

```r
tr_y_vec<- training$diagnosis
```

```
## Error in eval(expr, envir, enclos): object 'training' not found
```

```r
ksvm_Linear <- train(diagnosis ~ ., 
                     data = tr_subset, 
                     method = "svmLinear",
                     trControl=trctrl,
                     tuneLength = 10)
```

```
## Error in train(diagnosis ~ ., data = tr_subset, method = "svmLinear", : could not find function "train"
```

```r
kernfit_caret_sml<-ksvm_Linear$finalModel
```

```
## Error in eval(expr, envir, enclos): object 'ksvm_Linear' not found
```

```r
plot(kernfit_caret_sml, data = tr_x_subset)
```

```
## Error in plot(kernfit_caret_sml, data = tr_x_subset): object 'kernfit_caret_sml' not found
```

#Try with kernlab without caret, target separate



```r
# fit model and produce plot
kernfit_bc <- ksvm(x = tr_x_subset,
                   y = tr_y_vec,
                   type = "C-svc", 
                   kernel = 'vanilladot')
```

```
## Error in ksvm(x = tr_x_subset, y = tr_y_vec, type = "C-svc", kernel = "vanilladot"): could not find function "ksvm"
```

```r
plot(kernfit_bc, data = tr_x_subset)
```

```
## Error in plot(kernfit_bc, data = tr_x_subset): object 'kernfit_bc' not found
```


#Try with e1071 without caret, formula


```r
# fit model and produce plot
svmfit_bc <- svm(diagnosis ~ .,
                 data = tr_subset,
                 kernel = "linear", 
                 scale = TRUE)
```

```
## Error in svm(diagnosis ~ ., data = tr_subset, kernel = "linear", scale = TRUE): could not find function "svm"
```

```r
e1071:::plot.svm(svmfit_bc, data = tr_subset)#, radius_mean ~ cpw)
```

```
## Error in e1071:::plot.svm(svmfit_bc, data = tr_subset): object 'svmfit_bc' not found
```


#Try with e1071 without caret, formula, more variables


```r
#make subsets
tr_subset2<-training[,.(radius_mean, radius_se, cpw, diagnosis)]
```

```
## Error in eval(expr, envir, enclos): object 'training' not found
```

```r
tr_x_subset2<-as.matrix(training[,.(radius_mean, radius_se,cpw)])
```

```
## Error in as.matrix(training[, .(radius_mean, radius_se, cpw)]): object 'training' not found
```

```r
tr_y_vec2<- training$diagnosis
```

```
## Error in eval(expr, envir, enclos): object 'training' not found
```

```r
# fit model and produce plot
svmfit_bc <- svm(diagnosis ~ .,
                 data = tr_subset2,
                 kernel = "linear", 
                 scale = TRUE)
```

```
## Error in svm(diagnosis ~ ., data = tr_subset2, kernel = "linear", scale = TRUE): could not find function "svm"
```

```r
e1071:::plot.svm(svmfit_bc, radius_mean ~ cpw, data = tr_subset2)#, radius_mean ~ cpw)
```

```
## Error in e1071:::plot.svm(svmfit_bc, radius_mean ~ cpw, data = tr_subset2): object 'svmfit_bc' not found
```



#Try e1071 with caret


```r
set.seed(3233)

trctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
```

```
## Error in trainControl(method = "repeatedcv", number = 10, repeats = 3): could not find function "trainControl"
```

```r
svm_Linear_bc <- train(diagnosis ~ ., 
                     data = tr_subset, 
                     method = "svmLinearWeights",
                     trControl=trctrl,
                     preProcess = c("center", "scale"),
                     tuneLength = 10)
```

```
## Error in train(diagnosis ~ ., data = tr_subset, method = "svmLinearWeights", : could not find function "train"
```

```r
svmfit_caret_bc<-svm_Linear_bc$finalModel
```

```
## Error in eval(expr, envir, enclos): object 'svm_Linear_bc' not found
```

```r
plot(svmfit_caret_bc, tr_subset)
```

```
## Error in plot(svmfit_caret_bc, tr_subset): object 'svmfit_caret_bc' not found
```



```r
test_pred <- predict(svm_Linear, newdata = testing)
```

```
## Error in predict(svm_Linear, newdata = testing): object 'svm_Linear' not found
```

```r
test_pred
```

```
## Error in eval(expr, envir, enclos): object 'test_pred' not found
```

```r
#kernlab::plot(svm_Linear)#, data = training[,.(diagnosis, radius_mean,cpw)])
svm_Linear <- train(diagnosis ~ ., 
                    data = training[,.(diagnosis, radius_mean,cpw)], 
                    method = "svmLinear",
                    trControl=trctrl,
                    preProcess = c("center", "scale"),
                    tuneLength = 10)
```

```
## Error in train(diagnosis ~ ., data = training[, .(diagnosis, radius_mean, : could not find function "train"
```

```r
library(kernlab)

xd = as.matrix(training[,.(radius_mean,cpw)])
```

```
## Error in as.matrix(training[, .(radius_mean, cpw)]): object 'training' not found
```

```r
yd = as.matrix(training[,.(diagnosis)])
```

```
## Error in as.matrix(training[, .(diagnosis)]): object 'training' not found
```

```r
ksvm_Linear<-ksvm(x = xd,
                  y = yd,
                  kernel = "vanilladot", type = 'C-svc',
                  kpar = "automatic", C = .1, cross = 10)
```

```
## Error in ksvm(x = xd, y = yd, kernel = "vanilladot", type = "C-svc", kpar = "automatic", : object 'xd' not found
```

```r
plot(ksvm_Linear)
```

```
## Error in plot(ksvm_Linear): object 'ksvm_Linear' not found
```

```r
plot(ksvm_Linear, data = xd)
```

```
## Error in plot(ksvm_Linear, data = xd): object 'ksvm_Linear' not found
```

```r
kernlab::plot(ksvm_Linear, data = xd)
```

```
## Error in kernlab::plot(ksvm_Linear, data = xd): object 'ksvm_Linear' not found
```


```r
confusionMatrix(test_pred, testing$diagnosis )
```

```
## Error in confusionMatrix(test_pred, testing$diagnosis): could not find function "confusionMatrix"
```

```r
grid <- expand.grid(C = c(0,0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2,5))
set.seed(3233)
svm_Linear_Grid <- train(diagnosis ~ ., data = training, method = "svmLinear",
                         trControl=trctrl,
                         preProcess = c("center", "scale"),
                         tuneGrid = grid,
                         tuneLength = 10)
```

```
## Error in train(diagnosis ~ ., data = training, method = "svmLinear", trControl = trctrl, : could not find function "train"
```

```r
svm_Linear_Grid
```

```
## Error in eval(expr, envir, enclos): object 'svm_Linear_Grid' not found
```

```r
what_about_me<-svm_Linear_Grid$finalModel
```

```
## Error in eval(expr, envir, enclos): object 'svm_Linear_Grid' not found
```

```r
#plot(what_about_me, data = xd)
```


```r
test_pred_grid <- predict(svm_Linear_Grid, newdata = testing)
```

```
## Error in predict(svm_Linear_Grid, newdata = testing): object 'svm_Linear_Grid' not found
```

```r
test_pred_grid
```

```
## Error in eval(expr, envir, enclos): object 'test_pred_grid' not found
```


```r
confusionMatrix(test_pred_grid, testing$diagnosis )
```

```
## Error in confusionMatrix(test_pred_grid, testing$diagnosis): could not find function "confusionMatrix"
```

```r
set.seed(3233)
svm_Radial <- train(diagnosis ~., data = training, method = "svmRadial",
                    trControl=trctrl,
                    preProcess = c("center", "scale"),
                    tuneLength = 10)
```

```
## Error in train(diagnosis ~ ., data = training, method = "svmRadial", trControl = trctrl, : could not find function "train"
```

```r
svm_Radial
```

```
## Error in eval(expr, envir, enclos): object 'svm_Radial' not found
```

```r
plot(svm_Radial)
```

```
## Error in plot(svm_Radial): object 'svm_Radial' not found
```

```r
test_pred_Radial <- predict(svm_Radial, newdata = testing)
```

```
## Error in predict(svm_Radial, newdata = testing): object 'svm_Radial' not found
```

```r
test_pred_Radial
```

```
## Error in eval(expr, envir, enclos): object 'test_pred_Radial' not found
```

```r
confusionMatrix(test_pred_Radial, testing$diagnosis )
```

```
## Error in confusionMatrix(test_pred_Radial, testing$diagnosis): could not find function "confusionMatrix"
```


