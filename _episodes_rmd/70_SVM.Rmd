---
title: "Support vector machines"
author: "Darya Vanichkina"
keypoints:
- somepoint
objectives:
- someobjective
questions: What is the meaning of life FIXME?
source: Rmd
start: 0
teaching: 30
exercises: 0
---


Support Vector Machines 
Maximal Margin Classifier 
Linear Support Vector Classifier
Nonlinear Kernels
Polynomial Kernels
Gaussian radial based function
Support Vector Machines 
Multi-Class SVMs
Hyperplanes and maximal margin classifier
Sort margin and support vector classifier
Kernels and support vector machines

? Voting classifier (hard/soft)




```{r libraries}
library(caret)
library(data.table)
```

# Wisconsin Diagnositc Breast Cancer Dataset


```{r loadData}
wdbc<-fread(here::here("data/breast-cancer-wisconsin.csv"))

wdbc$diagnosis<-factor(wdbc$diagnosis)
```

# Aim

To create a classifier for predicting whether a breast cancer patient's tumor is malignant or benign.

```{r test_train_split}
set.seed(3033)
intrain <- createDataPartition(y = wdbc$diagnosis, p= 0.7, list = FALSE)
training <- wdbc[intrain,]
testing <- wdbc[-intrain,]
```


```{r standard_checks}
dim(training)

dim(testing)

anyNA(wdbc)

summary(wdbc)
```

```{r}
set.seed(3233)

trctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)

svm_Linear <- train(diagnosis ~., data = training, method = "svmLinear",
                    trControl=trctrl,
                    preProcess = c("center", "scale"),
                    tuneLength = 10)
svm_Linear
```
```{r}
test_pred <- predict(svm_Linear, newdata = testing)
test_pred
```

```{r, warning=F}

confusionMatrix(test_pred, testing$diagnosis )

```
```{r, warning=F}
grid <- expand.grid(C = c(0,0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2,5))
set.seed(3233)
svm_Linear_Grid <- train(diagnosis ~., data = training, method = "svmLinear",
                         trControl=trctrl,
                         preProcess = c("center", "scale"),
                         tuneGrid = grid,
                         tuneLength = 10)

svm_Linear_Grid

plot(svm_Linear_Grid)
```

```{r}
test_pred_grid <- predict(svm_Linear_Grid, newdata = testing)
test_pred_grid
```

```{r}
confusionMatrix(test_pred_grid, testing$diagnosis )
```
```{r}
set.seed(3233)
svm_Radial <- train(diagnosis ~., data = training, method = "svmRadial",
                    trControl=trctrl,
                    preProcess = c("center", "scale"),
                    tuneLength = 10)

svm_Radial
plot(svm_Radial)
```
```{r}
test_pred_Radial <- predict(svm_Radial, newdata = testing)
test_pred_Radial

confusionMatrix(test_pred_Radial, testing$diagnosis )
```


